<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="robots" content="noindex" />
    <title>Sveltia CMS</title>
  </head>
  <body>
    <script src="https://unpkg.com/@sveltia/cms/dist/sveltia-cms.js"></script>
    <script>
      CMS.registerEditorComponent({
        id: "arcweave-game",
        label: "Arcweave Game",
        icon: "sports_esports",
        fields: [
          {
            name: "gameId",
            label: "Game ID",
            widget: "string",
            hint: "The ID from the Arcweave URL (e.g., '2Kl8pwKlMZ' from arcweave.com/embed/2Kl8pwKlMZ/play)"
          },
          {
            name: "title",
            label: "Title",
            widget: "string",
            default: "Play Game",
            hint: "Accessible label for the play button"
          },
          {
            name: "poster",
            label: "Poster Image",
            widget: "image",
            required: false,
            hint: "Optional background image shown before the game loads"
          }
        ],
        pattern: /<GameEmbed\s+src="https:\/\/arcweave\.com\/embed\/(?<gameId>[^/]+)\/play"\s+title="(?<title>[^"]+)"(?:\s+poster="(?<poster>[^"]+)")?\s*\/>/,
        toBlock: ({ gameId, title, poster }) => {
          if (poster) {
            return `<GameEmbed src="https://arcweave.com/embed/${gameId}/play" title="${title}" poster="${poster}" />`;
          }
          return `<GameEmbed src="https://arcweave.com/embed/${gameId}/play" title="${title}" />`;
        },
        toPreview: ({ gameId, title, poster }) =>
          `<div style="background:#1a1a2e;color:#fff;padding:20px;border-radius:8px;text-align:center;${poster ? `background-image:url('${poster}');background-size:cover;` : ''}">
            <p>ðŸŽ® <strong>${title}</strong></p>
            <p style="font-size:12px;opacity:0.7;">Arcweave Game: ${gameId}</p>
          </div>`
      });
    </script>
  </body>
</html>
